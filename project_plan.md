# Project Plan: Motorsports Management Web App

## 1. Technology Stack

| Component | Technology |
| :--- | :--- |
| **Frontend** | React (with Vite) + TypeScript |
| **Backend** | Node.js with Express.js + TypeScript |
| **Database** | PostgreSQL |
| **ORM** | Prisma |
| **Authentication** | JSON Web Tokens (JWT) |
| **File Storage** | Amazon S3 (or compatible) |
| **Deployment** | Docker & Vercel/AWS |
| **Data Visualization**| Recharts |

## 2. Development Phases

| Phase | Task Description | Status |
| :--- | :--- | :--- |
| **1** | **Backend: Project & DB Setup**<br>1. Init Node.js/TypeScript project.<br>2. Install Express, Prisma.<br>3. Docker Compose for PostgreSQL.<br>4. Init Prisma & connect to DB. | Done |
| **2** | **Backend: `Vehicle` Model & API**<br>1. Define `Vehicle` model in `schema.prisma`.<br>2. Run `prisma migrate` to create table.<br>3. Create controller & router for `/api/vehicles` CRUD. | Done |
| **3** | **Frontend: Project Setup & Vehicle List**<br>1. Init React project (Vite/TypeScript).<br>2. Install Axios, React Router.<br>3. Create `VehicleListPage.tsx` to fetch & display vehicles. | Done |
| **4** | **Backend: `Event` Model & API**<br>1. Define `Event` model in `schema.prisma`.<br>2. Run migration.<br>3. Create controller & router for `/api/events` CRUD. | Done |
| **5** | **Frontend: Event List & Detail View**<br>1. Create `EventListPage.tsx` to display events.<br>2. Implement routing to `EventDetailPage.tsx`.<br>3. Detail page shows single event info. | Done |
| **6** | **Backend: `User` & `Driver` Models & Auth**<br>1. Define `User`/`Driver` models in Prisma.<br>2. Implement `/api/auth/register` & `/api/auth/login` endpoints.<br>3. Use bcrypt for hashing & JWT for tokens. | Done |
| **7** | **Frontend: Authentication Flow**<br>1. Create `LoginPage.tsx` & `RegisterPage.tsx`.<br>2. Store JWT securely on login.<br>3. Set up Axios interceptor to add auth token to requests. | Done |
| **8** | **Backend: `SetupSheet` Model & Relations**<br>1. Define `SetupSheet` model in Prisma.<br>2. Create relations to `Vehicle` and `Event`.<br>3. Build protected `/api/setups` endpoints. | Done |
| **9** | **Frontend: Digital Setup Sheet Form**<br>1. Create `SetupSheetForm.tsx` component.<br>2. Form POSTs data to `/api/setups`.<br>3. Display setups on `EventDetailPage`. | Done |
| **10** | **Frontend + Backend: Performance Analytics Dashboard**<br>1. Define `LapTime` model in Prisma with relations to `Driver`, `Vehicle`, and `Event`.<br>2. Run `prisma migrate` to create table.<br>3. Build `/api/analytics/laptimes` endpoints (POST to record, GET to retrieve by event/driver/vehicle).<br>4. Create `AnalyticsDashboardPage.tsx` with Recharts line and bar charts for lap time trends, driver comparisons, and vehicle performance. | Done |
| **11** | **Frontend: Vehicle Detail, Create & Edit Pages + Driver Roster**<br>1. Create `VehicleDetailPage.tsx` with specs, performance summary (best lap, total laps), and full lap time history table.<br>2. Create `VehicleFormPage.tsx` as a shared create/edit form with validation and category dropdown.<br>3. Create `DriversPage.tsx` as a driver roster with profile cards, role badges, and key stats.<br>4. Add `driverService.ts` and `driver.ts` types to the frontend.<br>5. Update `App.tsx` routing to wire all new pages and add Drivers nav link. | Done |
| **12** | **Backend + Frontend: Role-Based Access Control (RBAC)**<br>1. Create flexible `requireRole(...roles)` middleware for route-level authorization.<br>2. Protect all backend routes: viewers = read-only, users = read/write, admins = full access + user management.<br>3. Build admin-only `/api/admin/users` endpoints (list, update role, activate/deactivate).<br>4. Create `AdminPanelPage.tsx` with user management table (role editing, status toggling).<br>5. Add role-based nav visibility and route guards on the frontend. | Done |
| **13** | **Backend + Frontend: Weather Integration for Events**<br>1. Integrate a weather API (e.g., Open-Meteo) to fetch forecasts by event venue/date.<br>2. Build `/api/events/:id/weather` endpoint to return weather data.<br>3. Display weather widget on `EventDetailPage` with temperature, conditions, and wind. | Done |
| **14** | **Backend + Frontend: Parts & Inventory Management**<br>1. Define `Part` model in Prisma with fields for name, category, quantity, cost, and vehicle relation.<br>2. Run migration and build `/api/parts` CRUD endpoints.<br>3. Create `PartsPage.tsx` with inventory table, search/filter, and low-stock alerts. | Done |
| **15** | **Backend + Frontend: Photo & Document Uploads (S3)**<br>1. Configure S3-compatible storage with presigned upload URLs.<br>2. Build `/api/uploads` endpoints for file management.<br>3. Add photo galleries to Vehicle and Event detail pages with drag-and-drop upload UI. | Done |
| **16** | **Frontend: Responsive UI Polish & Dark Mode**<br>1. Implement CSS custom-property-based dark mode with toggle in navbar.<br>2. Audit and fix all responsive breakpoints for mobile, tablet, and desktop.<br>3. Add skeleton loading states and micro-animations for improved UX. | Done |
| **17** | **DevOps: Docker Deployment Configuration**<br>1. Create multi-stage `Dockerfile` for backend (build + production).<br>2. Create `Dockerfile` for frontend (Vite build + nginx serve).<br>3. Update `docker-compose.yml` to orchestrate backend, frontend, and PostgreSQL.<br>4. Add health checks, environment variable management, and production-ready configs. | Done |
| **18** | **DevOps: CI/CD with GitHub Actions**<br>1. Create `.github/workflows/ci.yml` to lint and build both backend and frontend on every push and pull request.<br>2. Create `.github/workflows/docker-publish.yml` to build and push multi-arch Docker images to GHCR on merge to `main`.<br>3. Add a `release.yml` workflow for semantic versioning and GitHub Release creation.<br>4. Configure repository secrets for GHCR credentials and environment-specific deployment tokens. | Not Started |
| **19** | **Backend: Unit & Integration Testing**<br>1. Install and configure Jest, Supertest, and a Prisma mock/test-db utility.<br>2. Create an isolated test database environment via a dedicated `.env.test` and `jest.config.ts`.<br>3. Write unit tests for auth, vehicle, event, and analytics controllers covering success and error paths.<br>4. Write integration tests for critical API flows (register → login → create vehicle → record lap time). | Not Started |
| **20** | **Frontend: Component & End-to-End Testing**<br>1. Install and configure Vitest and React Testing Library for component-level tests.<br>2. Write component tests for `SetupSheetForm`, `WeatherWidget`, `ProtectedRoute`, and `RoleGuard`.<br>3. Install and configure Playwright for browser-based end-to-end tests.<br>4. Write E2E tests covering core user flows: registration, login, create/edit vehicle, record lap time, and admin panel. | Not Started |
| **21** | **DevOps: Monitoring & Observability**<br>1. Integrate Pino structured logging throughout the backend; replace all `console.log` calls.<br>2. Add a `/api/metrics` endpoint exposing Prometheus-compatible metrics (request count, latency, error rate).<br>3. Integrate Sentry SDK into both backend and frontend for error tracking and performance monitoring.<br>4. Add a `StatusPage.tsx` to the frontend showing live API health, version, and uptime. | Not Started |
| **22** | **Backend + Frontend: Real-Time Notifications (WebSockets)**<br>1. Integrate Socket.IO into the backend Express server with JWT-authenticated connections.<br>2. Define `Notification` model in Prisma (id, recipientId, message, type, isRead, createdAt).<br>3. Build a notification service that emits real-time events on key actions (new setup sheet, event starting soon, low-stock part alert).<br>4. Add a notification bell component to the frontend navbar with a live unread count badge and dismissible dropdown. | Not Started |
| **23** | **Mobile App: React Native Scaffolding & Auth**<br>1. Initialize a `mobile/` directory using Expo with TypeScript and React Navigation.<br>2. Configure environment variables for the backend API URL and connect to existing endpoints.<br>3. Implement Login and Register screens using the existing `/api/auth` endpoints.<br>4. Implement secure JWT storage with Expo SecureStore and an Axios interceptor for authenticated requests. | Not Started |
| **24** | **Mobile App: Core Screens (Vehicles, Events, Lap Times)**<br>1. Create a `VehiclesScreen` with a list view and pull-to-refresh, linking to a `VehicleDetailScreen`.<br>2. Create an `EventsScreen` with upcoming/past event tabs and an `EventDetailScreen` showing weather and setup sheets.<br>3. Create a `RecordLapTimeScreen` with a stopwatch UI for live lap time entry linked to a selected event and vehicle.<br>4. Add a bottom tab navigator wiring all core screens together. | Not Started |
| **25** | **Advanced Analytics: Telemetry Data Ingestion & Visualization**<br>1. Define a `Telemetry` model in Prisma (speed, RPM, throttle, brake, gear, GPS lat/lng, timestamp) with a relation to `LapTime`.<br>2. Build a high-throughput `POST /api/telemetry/batch` endpoint for bulk telemetry ingestion from data loggers.<br>3. Build `GET /api/telemetry/:lapTimeId` to retrieve the full trace for a given lap.<br>4. Create a `TelemetryDetailPage.tsx` with synchronized multi-channel charts (speed, throttle, brake traces) and a GPS track map overlay using a canvas or SVG renderer. | Not Started |
